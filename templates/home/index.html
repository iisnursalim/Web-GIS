{% extends "home/base.html" %}
{% load static %}
{% load leaflet_tags %}

{% block Title %}
	Sistem Informasi Sarana dan Prasarana Wilayah Kabupaten Sidrap
{% endblock Title %}

{% block Leaflet_css %}

{% endblock Leaflet_css %}

{% block Heading %}

{% endblock Heading %}

{% block Contents %}
	<script> 
		function map_layers(map,option){
		// Add base map tiles from OpenstreetMap
			var street = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
				attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
				maxZoom: 20,
				id: 'mapbox/streets-v11',
				tileSize: 512,
				zoomOffset: -1,
				accessToken: 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw'
			});
			street.addTo(map);
			var satellite = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
				attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
				maxZoom: 20,
				id: 'mapbox/satellite-streets-v11',
				tileSize: 512,
				zoomOffset: -1,
				accessToken: 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NDg1bDA1cjYzM280NHJ5NzlvNDMifQ.d6e-nNyBDtmQCVwVNivz7A'
			});
		
		// Add data map from database with using L.GeoJSON.AJAX plugin.

			var Jalan = new L.GeoJSON.AJAX("{% url 'maps:data_jalan' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Nomor Ruas</td><td>: '+feature.properties.no_ruas+'</td></tr> <tr><td>Nama</td> <td>: '+feature.properties.nama_jalan+'</td></tr> <tr><td>Panjang Jalan (km)</td> <td>: '+feature.properties.panjang+'</td></tr> <tr><td>Lebar (m)</td> <td>: '+feature.properties.lebar+'</td></tr> <tr><td>Tipe Permukaan Jalan</td> <td>: '+feature.properties.tipe_perm+'</td></tr> <tr><td>Kondisi Jalan</td> <td>: '+feature.properties.kond_jalan+'</td></tr> <tr><td>Klasifikasi Jalan</td> <td>: '+feature.properties.kelas_jln+'</td></tr> </table>');
				},
			});


			var JalanPoint = new L.GeoJSON.AJAX("{% url 'maps:data_kondisi_jalan' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Nomor Ruas</td> <td>: '+feature.properties.nomor_ruas+'</td></tr> <tr><td>Nama Jalan</td> <td>: '+feature.properties.nama_jalan+'</td></tr> <tr><td>Status Administrasi</td> <td>: '+feature.properties.status_adm+'</td></tr></table>');
				},
			});

			var Jembatan = new L.GeoJSON.AJAX("{% url 'maps:data_jembatan' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Nomor Kode Jembatan</td> <td>: '+feature.properties.no_kode+'</td></tr> <tr><td>Nama Jembatan</td> <td>: '+feature.properties.nama+'</td></tr> <tr><td>Tipe Penyebrangan</td> <td>: '+feature.properties.tipe_sebra+'</td></tr></table>');
				},
			});

			var Kesehatan = new L.GeoJSON.AJAX("{% url 'maps:data_kesehatan' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Nama</td> <td>: '+feature.properties.nama+'</td></tr> <tr><td>Alamat</td> <td>: '+feature.properties.alamat+'</td></tr> <tr><td>Jenis Fasilitas Kesehatan</td> <td>: '+feature.properties.jenis+'</td></tr></table>');
				},
			});

			var Drainase = new L.GeoJSON.AJAX("{% url 'maps:data_drainase' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Kode Drainase</td> <td>: '+feature.properties.no_kode+'</td></tr> <tr><td>Ruas Pangkal-Ruas Ujung</td> <td>: '+feature.properties.rpru+'</td></tr> <tr><td>Kondisi Drainsase</td> <td>: '+feature.properties.kondisi+'</td></tr> </table>');
				},
			});
			
			var Pendidikan = new L.GeoJSON.AJAX("{% url 'maps:data_pendidikan' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Nama Sekolah</td> <td>:'+feature.properties.nama+'</td></tr> <tr><td>Alamat</td> <td>: '+feature.properties.alamat+'</td></tr> <tr><td>Jenjang</td> <td>: '+feature.properties.jenjang+'</td></tr></table>');
				},
			});

			var Kab_Sidrap = new L.GeoJSON.AJAX("{% url 'maps:data_kab_sidrap' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<table style="width:100%"> <tr><td>Desa</td> <td>: '+feature.properties.desa+'</td></tr> <tr><td>Kecamatan</td> <td>: '+feature.properties.kecamatan+'</td></tr></table>');
				},
			});

		// Add control layers
			var baseLayers = {
				"Streets": street,
				"Satellite": satellite
			}
			var overlayMaps = {
				"Layers": {
					"Jalan": Jalan,
					"Kondisi Jalan": JalanPoint,
					"Jembatan": Jembatan,
					"Kesehatan": Kesehatan,
					"Drainase": Drainase,
					"Pendidikan": Pendidikan,
					"Kab_Sidrap": Kab_Sidrap					
				}
			};
			L.control.groupedLayers(baseLayers, overlayMaps).addTo(map);
		}
	</script>
	
	{% leaflet_map "gis" callback="window.map_layers" %}
{% endblock Contents %}




